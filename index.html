<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ResumeFox AI â€” Prototype</title>
  <style>
    :root{
      --bg:#ffffff;
      --muted:#6b7280;
      --accent:#ff914d;
      --btn-bg:#e6f0ff;
      --success:#16a34a;
      --container-width:900px;
      --radius:10px;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      background:linear-gradient(180deg,#fff 0%, #fbfbff 100%);
      color:#111827;
      padding:32px;
    }
    .card{
      width:100%;
      max-width:var(--container-width);
      background:var(--bg);
      border-radius:16px;
      box-shadow: 0 6px 24px rgba(16,24,40,0.06);
      padding:48px;
      box-sizing:border-box;
      text-align:center;
    }
    h1{
      margin:0 0 6px 0;
      font-size:34px;
      letter-spacing: -0.02em;
    }
    .subtitle{
      color:var(--muted);
      margin-bottom:28px;
      font-size:15px;
    }
    .upload-row{
      display:flex;
      gap:16px;
      justify-content:center;
      margin-bottom:18px;
      flex-direction:column;
      align-items:center;
    }
    .btn{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      gap:10px;
      padding:14px 22px;
      border-radius:999px;
      border:0;
      cursor:pointer;
      font-weight:600;
      font-size:14px;
    }
    .btn-upload{
      background:var(--btn-bg);
      color:#0f172a;
      min-width:220px;
      box-shadow:none;
      border:1px solid rgba(15,23,42,0.04);
    }
    .btn-cta{
      background:var(--accent);
      color:white;
      min-width:220px;
      box-shadow: 0 6px 18px rgba(255,145,77,0.18);
    }
    input[type="file"]{
      display:none;
    }
    .small{
      font-size:13px;
      color:var(--muted);
      margin-top:6px;
    }

    /* Processing */
    .processing{
      display:none;
      margin-top:24px;
      align-items:center;
      justify-content:center;
      gap:12px;
      flex-direction:column;
    }
    .spinner{
      width:48px;height:48px;border-radius:50%;
      border:5px solid #eee;border-top-color:var(--accent);
      animation: spin 1s linear infinite;
    }
    @keyframes spin{to{transform:rotate(360deg)}}

    /* Results */
    .results{
      display:none;
      margin-top:32px;
      text-align:left;
    }
    .score{
      text-align:center;
      font-size:26px;
      font-weight:700;
      color:#2563eb;
      margin-bottom:16px;
    }
    .cols{
      display:flex;
      flex-direction:column;
      gap:32px;
      align-items:center;
      justify-content:center;
      margin-bottom:24px;
    }
    .col{
      min-width:260px;
      max-width:360px;
    }
    .section-title{
      font-weight:700;
      margin-bottom:8px;
      text-align:center;
    }
    ul{margin:0;padding-left:18px;color:var(--muted)}
    .recommended{
      text-align:center;
      margin-top:8px;
      font-weight:700;
    }
    .action-pill{
      display:inline-block;
      padding:10px 16px;
      border-radius:999px;
      color:white;
      font-weight:700;
      background:var(--success);
      margin-top:8px;
    }

    footer{
      margin-top:26px;
      text-align:center;
      color:var(--muted);
      font-size:13px;
    }
  </style>
</head>
<body>
  <div class="card">
    <h1>ResumeFox AI ðŸ¦Š</h1>
    <div class="subtitle">Smart Resume-to-Job Matching Tool</div>

    <!-- Upload buttons -->
    <div class="upload-row">
      <label class="btn btn-upload">
        <input id="fileResume" type="file" accept=".txt"/>
        Upload Resume
      </label>
      <div id="resumeStatus" class="small"></div>

      <label class="btn btn-upload">
        <input id="fileJD" type="file" accept=".txt"/>
        Upload Job Description
      </label>
      <div id="jdStatus" class="small"></div>
    </div>

    <!-- Analyze button -->
    <button id="analyzeBtn" class="btn btn-cta">Analyze Match</button>
    <div class="small">Upload small .txt files for demo</div>

    <!-- Processing -->
    <div id="processing" class="processing">
      <div class="spinner"></div>
      <div style="font-weight:700;color:#374151">Analyzing Resumeâ€¦</div>
      <div class="small">Fox is reviewing your resumeâ€¦</div>
    </div>

    <!-- Results -->
    <div id="results" class="results">
      <div class="score" id="scoreText">Match Score: â€” / 100</div>

      <div class="cols">
        <div class="col">
          <div class="section-title">Strengths</div>
          <ul id="strengthsList"><li>â€”</li></ul>
        </div>
        <div class="col">
          <div class="section-title">Weaknesses</div>
          <ul id="weaknessesList"><li>â€”</li></ul>
        </div>
      </div>

      <div style="text-align:center">
        <div class="recommended">Recommended Action</div>
        <div id="actionPill" class="action-pill">â€”</div>
      </div>

      <div style="text-align:center;margin-top:18px">
        <button id="again" class="btn btn-upload">Analyze Another</button>
      </div>
    </div>

    <footer>Powered by ResumeFox AI â€” Demo Version</footer>
  </div>

  <script>
    const fileResume = document.getElementById('fileResume');
    const fileJD = document.getElementById('fileJD');

    const resumeStatus = document.getElementById("resumeStatus");
    const jdStatus = document.getElementById("jdStatus");

    let resumeText = "";
    let jdText = "";

    function readFileAsText(file){
      return new Promise((resolve,reject)=>{
        const r = new FileReader();
        r.onload = ()=>resolve(r.result);
        r.onerror = ()=>reject("error");
        r.readAsText(file);
      });
    }

    fileResume.addEventListener("change", async(e)=>{
      if(e.target.files[0]){
        resumeText = await readFileAsText(e.target.files[0]);
        resumeStatus.textContent = "Resume Uploaded âœ”";
      }
    });

    fileJD.addEventListener("change", async(e)=>{
      if(e.target.files[0]){
        jdText = await readFileAsText(e.target.files[0]);
        jdStatus.textContent = "Job Description Uploaded âœ”";
      }
    });

    const processing = document.getElementById("processing");
    const results = document.getElementById("results");
    const analyzeBtn = document.getElementById("analyzeBtn");

    // REAL BACKEND CALL HERE
    analyzeBtn.addEventListener("click", async()=>{

      if(!resumeText || !jdText){
        alert("Upload both resume and JD first!");
        return;
      }

      processing.style.display="flex";
      results.style.display="none";

      try {
        const response = await fetch("https://ankitasuryawanshi400.app.n8n.cloud/webhook/resumefox-compare", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({
            resume: resumeText,
            jd: jdText
          })
        });

        const data = await response.json();
        console.log("AI RESPONSE:", data);
        

      // Extract safe values
      const text = data.candidates[0].content.parts[0].text;

      // Extract score
      const scoreMatch = text.match(/SCORE:\s*(\d+)/);
      const score = scoreMatch ? Number(scoreMatch[1]) : 0;

      // Extract strengths
      const strengthsBlock = text.split("STRENGTHS:")[1]?.split("WEAKNESSES:")[0] || "";
      const strengths = strengthsBlock
        .split("\n")
        .filter(l => l.trim().startsWith("-"))
        .map(l => l.replace("-", "").trim());

      // Extract weaknesses
      const weaknessesBlock = text.split("WEAKNESSES:")[1]?.split("ACTION:")[0] || "";
      const weaknesses = weaknessesBlock
        .split("\n")
        .filter(l => l.trim().startsWith("-"))
        .map(l => l.replace("-", "").trim());

      // Extract action
      const actionMatch = text.match(/ACTION:\s*(Interview|Review)/i);
      const action = actionMatch ? actionMatch[1] : "Review";

      showResults({
        score,
        strengths,
        weaknesses,
        recommended_action: action
    });
  


      } catch (err) {
        console.error(err);
        alert("Backend error â€” check n8n workflow!");
      }

    });

    function showResults(out){
      processing.style.display="none";
      results.style.display="block";

      document.getElementById("scoreText").textContent =
        `Match Score: ${out.score} / 100`;

      const sList = document.getElementById("strengthsList");
      const wList = document.getElementById("weaknessesList");
      sList.innerHTML = ""; 
      wList.innerHTML="";

      out.strengths.forEach(s=>{
        const li=document.createElement("li");
        li.textContent=s;
        sList.appendChild(li);
      });

      out.weaknesses.forEach(w=>{
        const li=document.createElement("li");
        li.textContent=w;
        wList.appendChild(li);
      });

      const pill=document.getElementById("actionPill");
      pill.textContent = out.recommended_action;
      pill.style.background = 
        out.recommended_action==="Interview" ? "#16a34a" : "#f59e0b";
    }

    document.getElementById("again").addEventListener("click",()=>{
      results.style.display="none";
      resumeText = "";
      jdText = "";
      fileResume.value="";
      fileJD.value="";
      resumeStatus.textContent = "";
      jdStatus.textContent = "";
    });

  </script>
</body>
</html>


